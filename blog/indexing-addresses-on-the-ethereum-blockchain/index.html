<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.e39e042e7eec95d16dbea72fab25218b73658bf732fcb20cb9254834001d874f4f41c07c7fdba542f90cb97f0678800780da41acb448a0ef8e5222d38cd7b5e2.css integrity="sha512-454ELn7sldFtvqcvqyUhi3Nli/cy/LIMuSVINAAdh09PQcB8f9ulQvkMuX8GeIAHgNpBrLRIoO+OUiLTjNe14g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Indexing Addresses on the Ethereum Blockchain - TrueBlocks</title><meta name=description content="Ethereum as it was meant to be: local-first, P2P, and accurate queries to all the data you’ll ever need."><link rel=canonical href=/blog/indexing-addresses-on-the-ethereum-blockchain/><meta name=twitter:card content="https://trueblocks.io/trueblocks.png"><meta name=twitter:image content="https://trueblocks.io/trueblocks.png"><meta name=twitter:title content="Indexing Addresses on the Ethereum Blockchain"><meta name=twitter:description content="Given a blockchain, our goal was to create a list of every appearance of every address in any block on that chain. We define an “appearance” as either the use of the address in one of the common ‘address’ fields of a transaction (such as to, from, or contractAddress) or its use as data in one of the data fields in a transaction. We do not check numeric fields such as value or gasUsed."><meta name=twitter:site content="@TrueBlocks"><meta name=twitter:creator content="@TrueBlocks"><meta property="og:title" content="Indexing Addresses on the Ethereum Blockchain"><meta property="og:description" content="Given a blockchain, our goal was to create a list of every appearance of every address in any block on that chain. We define an “appearance” as either the use of the address in one of the common ‘address’ fields of a transaction (such as to, from, or contractAddress) or its use as data in one of the data fields in a transaction. We do not check numeric fields such as value or gasUsed."><meta property="og:type" content="article"><meta property="og:url" content="/blog/indexing-addresses-on-the-ethereum-blockchain/"><meta property="og:image" content="https://trueblocks.io/trueblocks.png"><meta property="article:published_time" content="2019-07-09T02:30:51+00:00"><meta property="article:modified_time" content="2023-01-08T17:12:52-05:00"><meta property="og:site_name" content="TrueBlocks"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"\/blog\/indexing-addresses-on-the-ethereum-blockchain\/"},"headline":"Indexing Addresses on the Ethereum Blockchain","image":[],"datePublished":"2019-07-09T02:30:51CET","dateModified":"2023-01-08T17:12:52CET","author":{"@type":"Organization","name":"TrueBlocks"},"publisher":{"@type":"Organization","name":"TrueBlocks","logo":{"@type":"ImageObject","url":"\/logo-doks.png"}},"description":""}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Blogindexing Addresses on the Ethereum Blockchain","item":"\/blogindexing-addresses-on-the-ethereum-blockchain\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="blog single"><div class="header-bar fixed-top"></div><script>(localStorage.getItem("theme")==="dark"||localStorage.getItem("theme")===null)&&document.body.classList.add("dark")</script><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container-fluid><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=/>TrueBlocks</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://twitter.com/trueblocks><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><span class="ms-2 visually-hidden">Twitter</span></a></li><li class=nav-item><a class=nav-link href=https://discord.com/invite/kAFcZH2x7K><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="simple icon-discord"><path d="M20.317 4.3698a19.7913 19.7913.0 00-4.8851-1.5152.0741.0741.0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868.0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077.0 00-.0785-.037 19.7363 19.7363.0 00-4.8852 1.515.0699.0699.0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824.0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777.0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076.0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077.0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743.0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614.0a.0739.0739.0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077.0 01-.0066.1276 12.2986 12.2986.0 01-1.873.8914.0766.0766.0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076.0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077.0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061.0 00-.0312-.0286zM8.02 15.3312c-1.1825.0-2.1569-1.0857-2.1569-2.419.0-1.3332.9555-2.4189 2.157-2.4189 1.2108.0 2.1757 1.0952 2.1568 2.419.0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748.0c-1.1825.0-2.1569-1.0857-2.1569-2.419.0-1.3332.9554-2.4189 2.1569-2.4189 1.2108.0 2.1757 1.0952 2.1568 2.419.0 1.3332-.946 2.4189-2.1568 2.4189z"/></svg><span class="ms-2 visually-hidden">Discord</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/trueblocks/trueblocks-core><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li><li class=nav-item><a class=nav-link href=/api>API<span class="ms-2 visually-hidden">API</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=/docs/>Introduction</a></li><li class=nav-item><a class=nav-link href=/chifra/introduction>Chifra</a></li><li class=nav-item><a class=nav-link href=/data-model/intro>Data Model</a></li><li class=nav-item><a class=nav-link href=/explorer/introduction>Explorer</a></li><li class=nav-item><a class=nav-link href=/sdks/introduction>SDKs</a></li><li class="nav-item active"><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=/papers/>Papers</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-4M60J4ZGSQ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4M60J4ZGSQ",{anonymize_ip:!1})}</script></header><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Categories</h3><ul class=list-unstyled><li><a href=/tags/ethereum>ethereum</a> (28)</li><li><a href=/tags/trueblocks>trueblocks</a> (20)</li><li><a href=/tags/community>community</a> (6)</li><li><a href=/tags/tutorials>tutorials</a> (5)</li><li><a href=/tags/faq>faq</a> (1)</li><li><a href=/tags/trueblocks/>trueblocks</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Indexing Addresses on the Ethereum Blockchain</h1><div class=date><small><em>Published on: </em>Jul 9, 2019
<em>Last edited: </em>Jan 8, 2023</small><br></p></div><p class=lead>Appearances are the key</p><p>Given a blockchain, our goal was to create a list of every appearance of every address in any block on that chain. We define an “appearance” as either the use of the address in one of the common ‘address’ fields of a transaction (such as <code>to</code>, <code>from</code>, or <code>contractAddress</code>) or its use as data in one of the data fields in a transaction. We do not check numeric fields such as <code>value</code> or <code>gasUsed</code>.</p><p>An appearance consists of an <code>&lt; address / blockNum / tx_id ></code> tuple.</p><p>Given this list of appearances, we build an index sorted by address. This makes subsequent queries for all transactions on a given address easy and fast.</p><p>With a list of <code>transactions of interest</code>, we can then go back and query the blockchain for the details needed to do a full audit-quality, 100% decentralized, permissionless accounting, including “data accounting,” which means exposing the changes and current values of any of the smart contract’s state.</p><p>Because the ideas we’ve been working with are difficult to explain, especially to someone who is not familiar with the data structures used by Ethereum (as we suspect is the case for most of our readers), we try to explain what we’ve done through the following series of examples.</p><p>One thing to note. Every block is independent of every other block when it comes to extracting addresses in that block. Because of this, we are able to parallelize the work. We recently did that using golang in the latest version of our code called ‘blaze.’ We’re going to be in Berlin this summer. Hit us up if you’d like to discuss our work.</p><p>Examples follow…</p><p><img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-001.png alt>
<img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-002.png alt>
<img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-003.png alt>
<img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-004.png alt>
<img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-005.png alt>
<img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-006.png alt>
<img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-007.png alt></p><p>Each of the above examples is relatively easy. The addresses “appear” in obvious places in the transaction such as <code>from</code>, <code>to</code>, or as the event sender data in a log. There are more difficult cases. For example, a simple token transfer or a multi-sig wallet interaction.</p><p><img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-008.png alt>
<img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-009.png alt></p><p>The above examples, don’t explain everything. There are many, many edge cases and special cases. For example, if a smart contract reverts during its construction, the contract’s address is reported in the transaction receipt’s <code>contractAddress</code> field, but it does not appear anywhere in the transaction’s traces. In general, one can find every address by searching Parity’s traces and/or the event logs, but not in this case. There are other odd examples like this.</p><p>Because our process uses Parity’s traces, we must run <code>parity –tracing on</code>. This is made much easier with a product such as <a href=https://medium.com/u/8d628dbdf3c2>DAppNode</a> which will one day run our software (we hope).</p><h4 id=caveats>Caveats<a href=#caveats class=anchor aria-hidden=true>#</a></h4><p>There are a few unfortunate facts about the way the Ethereum blockchain stores data. The fact that we must remove <code>baddresses</code> and <code>precompiles</code>, and the fact that we need to create <em>fake</em> transactions in order to fully account for every address is fragile but necessary. It’s obvious to us that the designers of the Ethereum blockchain did not think through every edge case as relates to accounting for the chain — especially if one wishes to do this in a fully decentralized way. We suggest the designers of the next generation of blockchain clients pay more attention to the needs of those who wish to account for the system.</p><p>A careful reader will note that we only extract <strong>appearances</strong> from the blockchain. We do not extract any other data. This is an engineering choice we made because it was important that our system is able to run on commercial-grade hardware — by that we mean laptops. TrueBlocks works on a laptop! To us, this means “fully decentralized.” We gave up certain things in our design, such as broad statistical knowledge across the whole chain, but we wanted to build permissionless accounting all the out at the very edge. We’ve accomplished that.</p><p>As we extract the appearances, we periodically ‘consolidate’ the block-by-block data into a more easily searchable index. Unfortunately, it’s not as simple as shoving the appearances into an old-fashioned database. There’s nothing that stops us from doing that, but (as you might expect if you know anything about decentralized computing), it’s way more complicated than that. We want to make the index we’ve created easily sharable, uncapturable, undeniable, verifiable, and fully decentralized.</p><p>We’ll write about that in our next article.</p><h4 id=conclusion>Conclusion<a href=#conclusion class=anchor aria-hidden=true>#</a></h4><p>We fell in love with the idea of <code>permissionless accounting</code> about four years ago when we first heard <a href=https://medium.com/u/20ec8468cfbe>Joe Lubin</a> discuss the idea of triple-entry accounting and radical transparency. We’ve been working on that idea ever since, and recently — not the least due to our Ethereum Foundation grant — we’ve been making great progress. Just a quick preview of an application we’re building on the index and then we’re done. We didn’t ask if it was okay!</p><p><img src=/blog/img/031-Indexing-Addresses-on-the-Ethereum-Blockchain-010.png alt></p><h4 id=support-mywork>Support My Work<a href=#support-mywork class=anchor aria-hidden=true>#</a></h4><p>I’m interested in your thoughts. Please clap for us and post your comments below. Consider supporting our work. Send us a small (or large) contribution to 0xf503017d7baf7fbc0fff7492b751025c6a78179b.</p><p>Thomas Jay Rush owns the software company TrueBlocks whose primary project is also called TrueBlocks, a collection of software libraries and applications enabling real-time, per-block smart contract monitoring and analytics to the Ethereum blockchain. Contact him through the website.</p><p class=edit-page><a href=https://github.com/TrueBlocks/trueblocks-docs/blob/master/content/blog/2019/031-Indexing-Addresses-on-the-Ethereum-Blockchain.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=/blog/a-time-ordered-index-of-time-ordered-immutable-data/><div class="card my-1"><div class="card-body py-2">&larr; A Time Ordered Index of Time Ordered Immutable Data</div></div></a><a class=ms-auto href=/blog/mother-may-i/><div class="card my-1"><div class="card-body py-2">Mother May I? &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=https://github.com/TrueBlocks/trueblocks-docs>Improve docs</a></li><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/js/highlight.min.39c8701213290bff3f62f8bd4a85d5a89866c0e28d00395817ab598ba2b45df2cb63eb9afb36d0b00e8f6665d8baf67a2feb26a04839b46dfb9b18ed5bcebd44.js integrity="sha512-OchwEhMpC/8/Yvi9SoXVqJhmwOKNADlYF6tZi6K0XfLLY+ua+zbQsA6PZmXYuvZ6L+smoEg5tG37mxjtW869RA==" crossorigin=anonymous defer></script>
<script src=/main.min.faf5ce2fa16540fed2aa52654dcbc4d344816d8672fc99d99304faa64ddbac891a7d0e3e47633606fcdcd9fa6294254d76b3e9bfe4b3b55ef761780ee819898a.js integrity="sha512-+vXOL6FlQP7SqlJlTcvE00SBbYZy/JnZkwT6pk3brIkafQ4+R2M2Bvzc2fpilCVNdrPpv+SztV73YXgO6BmJig==" crossorigin=anonymous defer></script>
<script src=/index.min.ecf5abb7b18239119e9954b1777e59b327a280d0e505d51d9fca8fa883add071e58656a001826cbba414ac14219532f9b3ff8d4a499471f921c4e9709df02bf5.js integrity="sha512-7PWrt7GCORGemVSxd35ZsyeigNDlBdUdn8qPqIOt0HHlhlagAYJsu6QUrBQhlTL5s/+NSkmUcfkhxOlwnfAr9Q==" crossorigin=anonymous defer></script></body></html>